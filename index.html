<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Zist by ziscky</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Zist</h1>
      <h2 class="project-tagline">Think supervisord with remote commandeering via RPC.</h2>
      <a href="https://github.com/ziscky/zist" class="btn">View on GitHub</a>
      <a href="https://github.com/ziscky/zist/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/ziscky/zist/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="zist" class="anchor" href="#zist" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><strong>zist</strong>
</h1>

<p><a href="https://travis-ci.org/ziscky/zist"><img src="https://travis-ci.org/ziscky/zist.svg?branch=master" alt="Build Status"></a></p>

<h1>
<a id="think-supervisord-plus-remote-commandeering-via-rpc" class="anchor" href="#think-supervisord-plus-remote-commandeering-via-rpc" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Think supervisord plus remote commandeering via rpc</h1>

<hr>

<h2>
<a id="supervisor-functions" class="anchor" href="#supervisor-functions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Supervisor functions</h2>

<p>Register processes to be started and monitored in a familiar way using an easy to write toml file.
Sample: (Check Below)</p>

<h2>
<a id="live-process-interaction-via-web-api-and-rpc-client" class="anchor" href="#live-process-interaction-via-web-api-and-rpc-client" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Live Process Interaction via web API and RPC client</h2>

<ul>
<li>View process stats i.e cpu/mem usage</li>
<li>Start/Stop/Restart a process</li>
<li>Detach a process to allow it to run without zist supervision</li>
<li>View a list of all managed processes and valuable information e.g
<em>[{"isalive":true,"name":"xm","numrestarts":1,"path":"/home/eziscky/Golang/src/github.com/ziscky/tests/xm","pid":2067,"timealive":"13.410013177s","timestarted":"2015-12-17 13:36:44.540403109 +0300 EAT"}]</em>
</li>
<li>Get stdout/stderr process logs and log files.</li>
</ul>

<h2>
<a id="process-detach" class="anchor" href="#process-detach" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Process Detach</h2>

<ul>
<li>If you don't like the <em>coupling of your proc's instance with zist</em> you
can simply detach it after you're done monitoring it
<strong>N.B</strong> <em>Process Detach is only supported for direct invocation of binaries. So if you run a sh script, I'm working to support that. Or just send in a pull request :)</em>
</li>
</ul>

<h1>
<a id="future" class="anchor" href="#future" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>FUTURE</h1>

<ul>
<li>
<p>Live process hijacking.</p>

<h1>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>USAGE</h1>

<hr>
</li>
</ul>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<h3>
<a id="building-from-source" class="anchor" href="#building-from-source" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Building from source</h3>

<p>You will need to install Go (<em><a href="https://golang.org">https://golang.org</a></em>)
You can clone this repo: <em><a href="https://github.com/ziscky/zist">https://github.com/ziscky/zist</a></em> or use go get <em>github.com/ziscky/zist</em>
In the zist directory run the bash script <em>build.sh</em>
Run <em>sudo zist install</em>, or not <em>sudo</em> if you have correct permissions for:
        - /usr/bin
        - /etc 
On installation zistd and zistcl will be installed in <em>/usr/bin</em>. Typically for remote administration all you need on the server is zistd.</p>

<h3>
<a id="configuration" class="anchor" href="#configuration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Configuration</h3>

<p>Configurations are stored in <em>/etc/zist</em></p>

<p>The file of interest is <em>/etc/zist/conf.toml</em></p>

<p>It typically looks like this:
    - Maintain quotes for strings.</p>

<pre><code>Confdir = "/etc/zist/conf.d"
Web = true
Protocol = "http"
HTTPPort = 7000
Token = "zis"
RPCPort = 9876
</code></pre>

<p>These are the defaults.</p>

<pre><code>- Confdir: where zistd will look for process config files
- Web: if zistd will render process information via the web API
- Protocol: http or https
- HTTPPort: where the web API server will listen
- RPCPort: where the rpc server will listen
- Token: used to secure API/RPC connections
</code></pre>

<p>A few gotchas:
    - Strings in the config file should be in quotation. View <em><a href="https://github.com/toml-lang/toml">https://github.com/toml-lang/toml</a></em> for more on toml.
    - For https you have to provide the keyfile and certfile when running zist</p>

<p>Put your app config files in the Confdir directory specified in <em>conf.toml</em>
    - Each app/process/script must have its own file
    - The name of the file does not matter</p>

<pre><code>Name = "name of the process.(no spaces or special chars)"
Path = "/path/to/process"
Args = "-your -app -args"
Restart = true/false
Web = true/false 
</code></pre>

<h3>
<a id="running" class="anchor" href="#running" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Running</h3>

<p>Run it with <em>nohup zistd &amp;</em> to run it in the background.
To generate a secure token:
    - Run <em>zistd generate</em>
    - Copy the token to your config file</p>

<h3>
<a id="interaction" class="anchor" href="#interaction" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Interaction</h3>

<p>There are 2 ways to interact with a running zistd instance.</p>

<h4>
<a id="1-zistcl" class="anchor" href="#1-zistcl" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. zistcl</h4>

<pre><code>   zistcl is a commandline tool to interact with zistd.(Kinda like supervisord supervisorctl relationship)
   *You can get the following info and more by running zistcl -h*
   To connect to a zistd instance:
        *zistcl host:port token [cmd]* for remote connection to zistd
        *zistcl -l [cmd]* for local connection

        Examples:
        zistcl 1.1.1.1:9876 mysecuretoken status //Get zistd status
        zistcl -l log //get zistd log output
        zistcl -l app1 status //get app1 status
        zistcl 1.1.1.1:9876 mysecuretoken  app1 detach
</code></pre>

<h4>
<a id="2-web-api" class="anchor" href="#2-web-api" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. Web API</h4>

<pre><code>    Here are the API routes:
    Output is standard JSON.
            host:port/{token} -&gt; Gets All the monitored process info, including pid that can be used in the below requests 
            host:port/{token}/{pid}/stats
            host:port/{token}/{pid}/kill 
            host:port/{token}/{pid}/start
            host:port/{token}/{pid}/restart
            host:port/{token}/{pid}/stdout
            host:port/{token}/{pid}/stderr
            host:port/{token}/{pid}/detach
</code></pre>

<h1>
<a id="note" class="anchor" href="#note" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>NOTE</h1>

<pre><code>- Beta software do not use in prod
- Feel free to contribute
- Tell me what you do with it
- Works on Linux only
</code></pre>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/ziscky/zist">Zist</a> is maintained by <a href="https://github.com/ziscky">ziscky</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
